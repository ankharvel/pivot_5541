<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
        >
    <script type="text/javascript">
        function handleDrop(event, ui) {
            var droppedCar = ui.draggable;
            droppedCar.fadeOut('fast');
        }
    </script>
    <h:form id="genOpGrid">
        <h:panelGrid columns="2" cellpadding="5" width="500px">
            <p:outputLabel for="console" value="#{msg.option_select_source}"/>
            <p:selectOneMenu id="console" valueChangeListener="#{generateReportController.onMenuChange}"
                             onchange="submit();" style="width:180px">
                <f:selectItem itemLabel=" " itemValue="" />
                <f:selectItems value="#{uploadedTableController.uploadedFiles}"/>
            </p:selectOneMenu>
        </h:panelGrid>

        <p:spacer height="20"/>


        <h:panelGrid columns="9" rendered="#{generateReportController.enableDragMenu}">
            <p:fieldset id="dragSourceArea" legend="#{msg.header_source}">
                <p:dataGrid id="dropSourceArea" var="selectableColumn" value="#{generateReportController.columnSource}" columns="1">
                    <p:panel id="dragColumnSourcePnl">
                        <p:outputLabel value="#{selectableColumn.columnName}" style="text-align: left"/>
                        <i class="fa fa-paper-plane" style="float:right; color:#F2BC00"/>
                    </p:panel>
                    <p:draggable for="dragColumnSourcePnl" revert="true" handle=".ui-panel-content" stack=".ui-panel"/>
                </p:dataGrid>
            </p:fieldset>
            <p:spacer width="10"/>
            <p:fieldset id="dragRowsArea" legend="#{msg.header_rows}">
                <p:outputPanel id="dropRowsArea">
                    <h:outputText value="#{msg.adv_drag}" rendered="#{empty generateReportController.reportRows}" style="color: darkgrey" />

                    <p:dataGrid id="dropRowsData" var="selectableColumn" value="#{generateReportController.reportRows}"
                                columns="1" rendered="#{not empty generateReportController.reportRows}">
                        <p:panel>
                            <p:outputLabel value="#{selectableColumn.columnName}" style="text-align:left"/>
                            <p:commandButton id="removeRowBtn" process="dragRowsArea" icon="ui-icon-closethick" value=""
                                             action="#{generateReportController.removeRow(selectableColumn)}"
                                             ajax="false" update="dropSourceArea dropRowsArea"/>
                        </p:panel>
                    </p:dataGrid>
                </p:outputPanel>
            </p:fieldset>
            <p:spacer width="10"/>
            <p:fieldset id="dragColumnsArea" legend="#{msg.header_columns}">
                <p:outputPanel id="dropColumnsArea">
                    <h:outputText value="#{msg.adv_drag}" rendered="#{empty generateReportController.reportColumns}" style="color: darkgrey"/>

                    <p:dataGrid var="selectableColumn" value="#{generateReportController.reportColumns}"
                                columns="1" rendered="#{not empty generateReportController.reportColumns}">
                        <p:panel>
                            <p:outputLabel value="#{selectableColumn.columnName}" style="text-align: left"/>
                            <p:commandButton id="removeColBtn" process="dragColumnsArea" icon="ui-icon-closethick" value=""
                                             action="#{generateReportController.removeColumn(selectableColumn)}"
                                             ajax="false" update="dropSourceArea dropColumnsArea"/>
                        </p:panel>
                    </p:dataGrid>
                </p:outputPanel>
            </p:fieldset>
            <p:spacer width="10"/>
            <p:fieldset id="dragFiltersArea" legend="#{msg.header_filter}">
                <p:outputPanel id="dropFiltersArea">
                    <h:outputText value="#{msg.adv_drag}" rendered="#{empty generateReportController.reportFilters}" style="color: darkgrey"/>

                    <p:dataGrid var="selectableColumn" value="#{generateReportController.reportFilters}"
                                columns="1" rendered="#{not empty generateReportController.reportFilters}">
                        <p:panel>
                            <p:outputLabel value="#{selectableColumn.columnName}" style="text-align: left"/>
                            <p:commandButton id="removeFilterBtn" process="dragFiltersArea" icon="ui-icon-closethick" value=""
                                             action="#{generateReportController.removeFilter(selectableColumn)}"
                                             ajax="false" update="dropSourceArea dropFiltersArea"/>
                        </p:panel>
                    </p:dataGrid>
                </p:outputPanel>
            </p:fieldset>
            <p:spacer width="10"/>
            <p:fieldset id="dragFieldsArea" legend="#{msg.header_field}">
                <p:outputPanel id="dropFieldsArea">
                    <div>
                        <h:panelGrid columns="1" cellpadding="0">
                            <p:selectOneMenu id="aggregateComp" style="width: 112px">
                                <f:selectItem itemLabel=" " itemValue="" />
                                <f:selectItem itemLabel="Sumation" itemValue="SUM" />
                                <f:selectItem itemLabel="Average" itemValue="AVG" />
                            </p:selectOneMenu>
                        </h:panelGrid>
                    </div>
                    <div style="width: 100%">
                        <h:outputText value="#{msg.adv_drag}" rendered="#{empty generateReportController.reportField}" style="color: darkgrey"/>
                    </div>
                    <p:dataGrid var="selectableColumn" value="#{generateReportController.reportField}"
                                columns="1" rendered="#{not empty generateReportController.reportField}">
                        <p:panel>
                            <p:outputLabel value="#{selectableColumn.columnName}" style="text-align: left"/>
                            <p:commandButton id="removeFieldBtn" process="dragFieldsArea" icon="ui-icon-closethick" value=""
                                             action="#{generateReportController.removeField(selectableColumn)}"
                                             ajax="false" update="dropSourceArea dropFieldsArea"/>
                        </p:panel>
                    </p:dataGrid>
                </p:outputPanel>
            </p:fieldset>

        </h:panelGrid>

        <p:droppable for="dragRowsArea" tolerance="pointer" activeStyleClass="ui-state-highlight" datasource="dropSourceArea" onDrop="handleDrop">
            <p:ajax listener="#{generateReportController.onSourceToRow}" update="dropSourceArea dropRowsArea" />
        </p:droppable>

        <p:droppable for="dragColumnsArea" tolerance="pointer" activeStyleClass="ui-state-highlight" datasource="dropSourceArea" onDrop="handleDrop">
            <p:ajax listener="#{generateReportController.onSourceToColumn}" update="dropSourceArea dropColumnsArea" />
        </p:droppable>

        <p:droppable for="dragFiltersArea" tolerance="pointer" activeStyleClass="ui-state-highlight" datasource="dropSourceArea" onDrop="handleDrop">
            <p:ajax listener="#{generateReportController.onSourceToFilter}" update="dropSourceArea dropFiltersArea" />
        </p:droppable>

        <p:droppable for="dragFieldsArea" tolerance="pointer" activeStyleClass="ui-state-highlight" datasource="dropSourceArea" onDrop="handleDrop">
            <p:ajax listener="#{generateReportController.onSourceToField}" update="dropSourceArea dropFieldsArea" />
        </p:droppable>

    </h:form>
</ui:composition>